"use strict";(self["webpackChunkvue_shop"]=self["webpackChunkvue_shop"]||[]).push([[720],{3720:function(t,e,r){r.r(e),r.d(e,{default:function(){return l}});var o=function(){var t=this,e=t._self._c;return e("div",[e("ProductFrom",{attrs:{isEdit:!1}})],1)},n=[],a=r(8574),i={components:{ProductFrom:a.Z}},c=i,u=r(1001),s=(0,u.Z)(c,o,n,!1,null,null,null),l=s.exports},8574:function(t,e,r){r.d(e,{Z:function(){return f}});var o=function(){var t=this,e=t._self._c;return e("div",[e("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.product,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"属性分类"}},[e("el-select",{attrs:{placeholder:"请选择"},model:{value:t.product.categoryId,callback:function(e){t.$set(t.product,"categoryId",e)},expression:"product.categoryId"}},t._l(t.categories,(function(r){return e("el-option-group",{key:r.id,attrs:{label:r.name}},t._l(r.children,(function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)})),1)],1),e("el-form-item",{attrs:{label:"商品名称",prop:"name"}},[e("el-input",{model:{value:t.product.name,callback:function(e){t.$set(t.product,"name",e)},expression:"product.name"}})],1),e("el-form-item",{attrs:{label:"图片",prop:"image"}},[e("el-upload",{staticClass:"image-uploader",attrs:{action:"http://up-z2.qiniup.com/","show-file-list":!1,"on-success":t.handleImageSuccess,"before-upload":t.beforeImageUpload,data:t.uploadData,name:"file"}},[t.imageUrl?e("img",{staticClass:"image",attrs:{src:t.imageUrl}}):e("i",{staticClass:"el-icon-plus image-uploader-icon"})])],1),e("el-form-item",{attrs:{label:"单价",prop:"price"}},[e("el-input",{model:{value:t.product.price,callback:function(e){t.$set(t.product,"price",t._n(e))},expression:"product.price"}})],1),e("el-form-item",{attrs:{label:"上架"}},[e("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":""},model:{value:t.product.sale,callback:function(e){t.$set(t.product,"sale",e)},expression:"product.sale"}})],1),e("el-form-item",{attrs:{label:"推荐"}},[e("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":""},model:{value:t.product.recommend,callback:function(e){t.$set(t.product,"recommend",e)},expression:"product.recommend"}})],1),e("el-form-item",{attrs:{label:"置顶"}},[e("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":""},model:{value:t.product.top,callback:function(e){t.$set(t.product,"top",e)},expression:"product.top"}})],1),e("el-form-item",{attrs:{label:"新品"}},[e("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":""},model:{value:t.product.new,callback:function(e){t.$set(t.product,"new",e)},expression:"product.new"}})],1),e("el-form-item",{attrs:{label:"热门"}},[e("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":""},model:{value:t.product.hot,callback:function(e){t.$set(t.product,"hot",e)},expression:"product.hot"}})],1),e("el-form-item",{attrs:{label:"内容",prop:"title"}},[e("quill-editor",{ref:"myQuillEditor",attrs:{options:t.editorOption},model:{value:t.product.body,callback:function(e){t.$set(t.product,"body",e)},expression:"product.body"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("ruleForm")}}},[t._v(t._s(t.isEdit?"编辑":"创建"))]),e("el-button",{on:{click:function(e){return t.resetForm("ruleForm")}}},[t._v("重置")])],1)],1)],1)},n=[],a=r(9998),i=r(1591),c=r(9343),u=r(3029),s=r(7715),l={components:{quillEditor:s.quillEditor},props:{isEdit:{type:Boolean,default:!1}},data(){return{categories:[],product:{},uploadData:{token:"",key:""},imageUrl:"",editorOption:{placeholder:"请输入文章内容"},searchParams:{name:"",categoryId:""}}},created(){this.isEdit&&this.init(),this.test()},methods:{async init(){if(this.isEdit){const t=await(0,i.t2)(this.$route.params.id);this.imageUrl=t.data.product.image,this.product=t.data.product}},async test(){const t=await(0,a.zH)();this.categories=t.data.categories},submitForm(t){this.$refs[t].validate((async t=>{if(t){let t;if(t=this.isEdit?await(0,i.Js)(this.$route.params.id,this.product):await(0,i.LT)(this.product),2e4!==t.code)return void this.$message.error(t.message);this.$message.success(t.message),this.$router.push({name:"productsList"})}}))},resetForm(t){this.$refs[t].resetFields()},handleImageSuccess(t,e){this.imageUrl=URL.createObjectURL(e.raw),this.product.image=`http://ria894its.hn-bkt.clouddn.com/${t.key}`},async beforeImageUpload(t){const e="image/jpeg"===t.type,r="image/png"===t.type,o="image/gif"===t.type,n=t.size/1024/1024<2;if(!e&&!r&&!o)return this.$message.error("上传头像图片只能是 JPG,PNG,GIF 格式!"),!1;if(!n)return this.$message.error("上传头像图片大小不能超过 2MB!"),!1;const a=await(0,c.E)();this.uploadData.token=a.data.uploadToken;const i=t.type.split("/")[1];this.uploadData.key=`${(0,u.Z)()}.${i}`}}},d=l,p=r(1001),m=(0,p.Z)(d,o,n,!1,null,null,null),f=m.exports},3029:function(t,e,r){r.d(e,{Z:function(){return d}});const o="undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var n={randomUUID:o};r(8675),r(7380),r(1118),r(1703);let a;const i=new Uint8Array(16);function c(){if(!a&&(a="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!a))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(i)}const u=[];for(let p=0;p<256;++p)u.push((p+256).toString(16).slice(1));function s(t,e=0){return(u[t[e+0]]+u[t[e+1]]+u[t[e+2]]+u[t[e+3]]+"-"+u[t[e+4]]+u[t[e+5]]+"-"+u[t[e+6]]+u[t[e+7]]+"-"+u[t[e+8]]+u[t[e+9]]+"-"+u[t[e+10]]+u[t[e+11]]+u[t[e+12]]+u[t[e+13]]+u[t[e+14]]+u[t[e+15]]).toLowerCase()}function l(t,e,r){if(n.randomUUID&&!e&&!t)return n.randomUUID();t=t||{};const o=t.random||(t.rng||c)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,e){r=r||0;for(let t=0;t<16;++t)e[r+t]=o[t];return e}return s(o)}var d=l},1591:function(t,e,r){r.d(e,{F2:function(){return u},Js:function(){return c},LT:function(){return i},Zx:function(){return s},_q:function(){return n},t2:function(){return a}});var o=r(4471);function n(t){return(0,o.Z)({url:"/admin/products",method:"get",params:t})}function a(t){return(0,o.Z)({url:`http://localhost:3000/admin/products/${t}`,method:"get"})}function i(t){return(0,o.Z)({url:"http://localhost:3000/admin/products",method:"post",data:t})}function c(t,e){return(0,o.Z)({url:`http://localhost:3000/admin/products/${t}`,method:"put",data:e})}function u(t){return(0,o.Z)({url:`http://localhost:3000/admin/products/${t}`,method:"delete"})}function s(t,e){return(0,o.Z)({url:`http://localhost:3000/admin/products/${t}/change_attr`,method:"patch",data:e})}},9998:function(t,e,r){r.d(e,{Bp:function(){return i},DA:function(){return u},cs:function(){return s},qT:function(){return a},tU:function(){return c},zH:function(){return n}});var o=r(4471);function n(t){return(0,o.Z)({url:"/admin/categories",method:"get",params:t})}function a(t){return(0,o.Z)({url:`/admin/categories/${t}`,method:"get"})}function i(t){return(0,o.Z)({url:"/admin/categories",method:"post",data:t})}function c(t,e){return(0,o.Z)({url:`/admin/categories/${t}`,method:"put",data:e})}function u(t){return(0,o.Z)({url:`/admin/categories/${t}`,method:"delete"})}function s(t,e){return(0,o.Z)({url:`/admin/categories/${t}/change_sort`,method:"patch",data:e})}},9343:function(t,e,r){r.d(e,{E:function(){return n}});var o=r(4471);function n(){return(0,o.Z)({url:"/admin/uploads",method:"get"})}}}]);
//# sourceMappingURL=720.6933f346.js.map