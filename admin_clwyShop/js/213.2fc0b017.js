"use strict";(self["webpackChunkvue_shop"]=self["webpackChunkvue_shop"]||[]).push([[213],{4213:function(t,e,r){r.r(e),r.d(e,{default:function(){return l}});var a=function(){var t=this,e=t._self._c;return e("div",[e("ShopForm",{attrs:{isEdit:!0}})],1)},o=[],n=r(9905),i={components:{ShopForm:n.Z}},s=i,u=r(1001),c=(0,u.Z)(s,a,o,!1,null,null,null),l=c.exports},9905:function(t,e,r){r.d(e,{Z:function(){return d}});var a=function(){var t=this,e=t._self._c;return e("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.category,rules:t.rules,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"上级分类"}},[e("el-select",{attrs:{placeholder:"活动区域"},model:{value:t.category.parentId,callback:function(e){t.$set(t.category,"parentId",e)},expression:"category.parentId"}},[e("el-option",{attrs:{label:"默认",value:0}}),t._l(t.categories,(function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],2)],1),e("el-form-item",{attrs:{label:"分类名称",prop:"name"}},[e("el-input",{model:{value:t.category.name,callback:function(e){t.$set(t.category,"name",e)},expression:"category.name"}})],1),e("el-form-item",{attrs:{label:"排序",prop:"sort"}},[e("el-input",{model:{value:t.category.sort,callback:function(e){t.$set(t.category,"sort",t._n(e))},expression:"category.sort"}})],1),0!==t.category.parentId?e("el-form-item",{attrs:{label:"图片",prop:"image"}},[e("el-upload",{staticClass:"image-uploader",attrs:{action:"http://up-z2.qiniup.com/","show-file-list":!1,"on-success":t.handleImageSuccess,"before-upload":t.beforeImageUpload,data:t.uploadData,name:"file"}},[t.imageUrl?e("img",{staticClass:"image",attrs:{src:t.imageUrl}}):e("i",{staticClass:"el-icon-plus image-uploader-icon"})])],1):t._e(),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("ruleForm")}}},[t._v(t._s(t.isEdit?"编辑":"创建"))]),e("el-button",{on:{click:function(e){return t.resetForm("ruleForm")}}},[t._v("重置")])],1)],1)},o=[],n=r(9998),i=r(9343),s=r(3029),u={props:{isEdit:{type:Boolean,default:!1}},data(){return{category:{name:"",sort:""},uploadData:{token:"",key:""},imageUrl:"",categories:[],rules:{name:[{required:!0,message:"请输入分类名称",trigger:"blur"},{min:2,max:15,message:"长度在 2 到 15 个字符",trigger:"blur"}],sort:[{required:!0,message:"请输入排序",trigger:"blur"}]}}},created(){this.init(this.isEdit),this.shopList()},methods:{async init(){if(this.isEdit){const t=await(0,n.qT)(this.$route.params.id);this.category=t.data.category,this.imageUrl=t.data.category.image}},async shopList(){const t=await(0,n.zH)();this.categories=t.data.categories},submitForm(t){this.$refs[t].validate((async t=>{if(t){let t;if(t=this.isEdit?await(0,n.tU)(this.$route.params.id,this.category):await(0,n.Bp)(this.category),2e4!==t.code)return void this.$message.error(t.message);this.$message.success(t.message),this.$router.push({name:"shopList"})}}))},handleImageSuccess(t,e){this.imageUrl=URL.createObjectURL(e.raw),this.category.image=`http://ria894its.hn-bkt.clouddn.com/${t.key}`},async beforeImageUpload(t){const e="image/jpeg"===t.type,r="image/png"===t.type,a="image/gif"===t.type,o=t.size/1024/1024<2;if(!e&&!r&&!a)return this.$message.error("上传头像图片只能是 JPG,PNG,GIF 格式!"),!1;if(!o)return this.$message.error("上传头像图片大小不能超过 2MB!"),!1;const n=await(0,i.E)();this.uploadData.token=n.data.uploadToken;const u=t.type.split("/")[1];this.uploadData.key=`${(0,s.Z)()}.${u}`},resetForm(t){this.$refs[t].resetFields()}}},c=u,l=r(1001),m=(0,l.Z)(c,a,o,!1,null,null,null),d=m.exports},3029:function(t,e,r){r.d(e,{Z:function(){return m}});const a="undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var o={randomUUID:a};r(8675),r(7380),r(1118),r(1703);let n;const i=new Uint8Array(16);function s(){if(!n&&(n="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!n))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(i)}const u=[];for(let d=0;d<256;++d)u.push((d+256).toString(16).slice(1));function c(t,e=0){return(u[t[e+0]]+u[t[e+1]]+u[t[e+2]]+u[t[e+3]]+"-"+u[t[e+4]]+u[t[e+5]]+"-"+u[t[e+6]]+u[t[e+7]]+"-"+u[t[e+8]]+u[t[e+9]]+"-"+u[t[e+10]]+u[t[e+11]]+u[t[e+12]]+u[t[e+13]]+u[t[e+14]]+u[t[e+15]]).toLowerCase()}function l(t,e,r){if(o.randomUUID&&!e&&!t)return o.randomUUID();t=t||{};const a=t.random||(t.rng||s)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,e){r=r||0;for(let t=0;t<16;++t)e[r+t]=a[t];return e}return c(a)}var m=l},9998:function(t,e,r){r.d(e,{Bp:function(){return i},DA:function(){return u},cs:function(){return c},qT:function(){return n},tU:function(){return s},zH:function(){return o}});var a=r(4471);function o(t){return(0,a.Z)({url:"/admin/categories",method:"get",params:t})}function n(t){return(0,a.Z)({url:`/admin/categories/${t}`,method:"get"})}function i(t){return(0,a.Z)({url:"/admin/categories",method:"post",data:t})}function s(t,e){return(0,a.Z)({url:`/admin/categories/${t}`,method:"put",data:e})}function u(t){return(0,a.Z)({url:`/admin/categories/${t}`,method:"delete"})}function c(t,e){return(0,a.Z)({url:`/admin/categories/${t}/change_sort`,method:"patch",data:e})}},9343:function(t,e,r){r.d(e,{E:function(){return o}});var a=r(4471);function o(){return(0,a.Z)({url:"/admin/uploads",method:"get"})}}}]);
//# sourceMappingURL=213.2fc0b017.js.map